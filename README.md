# Plant-identification-of-Namibian-Encroacher-Bush
This code forrm prat of the MEng structured project of Pascal Marggraff. Authors: Pascal Marggraff and Dr MP Venter. Aim of this project is to identify bushes and trees within the Namibian environment.
In the Train.py file, the input are 4000 images per class. Shadows are removed from the image by dividing the images into their r,g and b channels and from each channel the brighter pixels are dilated. Thereafter, the image is converted to the HSV colourspace and all grass and sky is removed. It turns out that bushes appear bright green in the HSV colourspace, whereas trees appear red. This enables the feature extraction of these two classes on different colour histogram bin sizes. The output of this program are feature vectors for each filter with its increased bin size and their corresponding labels (in h5py format stored to output).
Test.py imports the feature vectors and labels from before, as well as 200 test images. The features and labels are fit to an RF classifier, which is tuned using random search cross validtation. At first, the images are segmented using the SLIC superpixel algorythm from NumPY. It turns out that for most of the images, the second superpixel contains the region of interest i.e. the bushes or trees. A sliding window is now applied to this SLIC mask and it predicts the class. The prediction results are stored to text files, which are saved under the textfiles folder. In the text files, the following structure exists: Image_directory Number_of_instances_found x1,y1,x2,y2. Image_directory is the directory of the current image, Number_of_instances_found is the number of instances the specified class was found and x1,y1,x2,y2 are the sliding window coordinates. If the SLIC mask covered less than half of the pixels within the image, then it is assumed that the region of interest was not segmented by SLIC. Now, the remaining region of the image is filtered by using gamma correction to adjust the image contrast, to eliminate shadows. Again with HSV segmentation, sky, grass and sand is removed. The sliding window is then applied to the remainder of the image and the same stowing process is applied. 
Now, a final decision has to be made, of the class that the algorythm is predicting. Essentially, we have 5 different filters that each gave their prediction. At first all 10 text files (one for each class and there are five filters) are opened, so that the predicted regions can be made visible on empty arrays. These arrays, where the predictions are plotted on are added with the OpenCV function cv2.add(). So, essentially, the filters have all decided on a region, where instances have been found. Using SLIC again, this region is segmented out and used as a mask. Each filters array is inserted in this mask and with a histogram, it is decided, which class is finally predicted by the filter. This works as follows: Red rectangles, originating from the prediction of the sliding window, mean that woody areas/ trees have been idemtified. Green means that leafy biomass/ bushes have been found. If the histogram is dominantly green within the SLIC mask, then a bush was found; else it was a tree. So now the filters also get a vote for the class that was found. Majority vote wins and so the region and class was decided upon.
